{% extends 'professor_dashboard.html' %}
{% block body %}

<style>
/* ================= ANIMATIONS ================= */
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

@keyframes pulse-soft {
  0% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0.4); }
  70% { box-shadow: 0 0 0 10px rgba(99, 102, 241, 0); }
  100% { box-shadow: 0 0 0 0 rgba(99, 102, 241, 0); }
}

/* ================= MAIN WRAPPER ================= */
.publish-wrapper {
  background: radial-gradient(circle at top, #0b1220 0%, #020617 70%);
  border-radius: 20px;
  padding: 3rem 2.5rem;
  box-shadow: 
    0 0 0 1px rgba(99,102,241,0.25),
    0 40px 90px rgba(0,0,0,0.8);
  max-width: 750px;
  margin: 3rem auto;
  text-align: center;
  position: relative;
  overflow: hidden;
  animation: fadeInUp 0.6s ease-out forwards;
  border: 1px solid rgba(255,255,255,0.05);
}

/* Glassy decorative element */
.publish-wrapper::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, rgba(99,102,241,0.05) 0%, transparent 60%);
  pointer-events: none;
}

/* ================= HEADER ================= */
.publish-title {
  color: #ffffff;
  font-weight: 800;
  letter-spacing: 0.5px;
  margin-bottom: 2rem;
  font-size: 1.8rem;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 12px;
  position: relative;
  z-index: 1;
}

.publish-title span {
  background: rgba(99,102,241,0.2);
  border-radius: 50%;
  width: 48px;
  height: 48px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  box-shadow: 0 0 20px rgba(99,102,241,0.3);
  color: #a5b4fc;
}

/* ================= FORM ELEMENTS ================= */
.publish-form {
  display: flex;
  flex-direction: column;
  gap: 1.5rem;
  text-align: left;
  position: relative;
  z-index: 1;
}

.publish-form label {
  color: #c7d2fe;
  font-weight: 600;
  font-size: 0.95rem;
  margin-left: 0.2rem;
  display: flex;
  align-items: center;
  gap: 8px;
}

.custom-select {
  background: rgba(15, 23, 42, 0.8);
  border: 1px solid rgba(148,163,184,0.2);
  color: #ffffff;
  padding: 1rem 1.2rem;
  border-radius: 12px;
  font-size: 1rem;
  width: 100%;
  cursor: pointer;
  transition: all 0.2s ease;
  appearance: none;
  -webkit-appearance: none;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='%2394a3b8' viewBox='0 0 16 16'%3E%3Cpath d='M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 1.2rem center;
  background-size: 12px;
}

.custom-select:focus {
  outline: none;
  border-color: #6366f1;
  box-shadow: 0 0 0 3px rgba(99,102,241,0.25);
  background-color: #1e293b;
}

/* ================= BUTTON ================= */
.publish-btn {
  background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%);
  border: 1px solid rgba(255,255,255,0.1);
  color: #ffffff;
  font-weight: 700;
  letter-spacing: 1px;
  padding: 1.1rem;
  border-radius: 12px;
  width: 100%;
  margin-top: 1rem;
  transition: all 0.3s ease;
  text-transform: uppercase;
  font-size: 0.95rem;
  cursor: pointer;
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 10px;
}

.publish-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 10px 30px -5px rgba(79, 70, 229, 0.6); 
  background: linear-gradient(135deg, #4f46e5 0%, #4338ca 100%);
  animation: pulse-soft 2s infinite;
}

/* ================= EMPTY STATE ================= */
.no-data {
  text-align: center;
  padding: 3rem;
  color: #94a3b8;
}

.no-data h4 {
  color: #f1f5f9;
  font-size: 1.4rem;
  font-weight: 700;
  margin-bottom: 0.5rem;
  margin-top: 1rem;
}
</style>

<div class="container-fluid mt-5 mb-5">
  <div class="row justify-content-center">
    <div class="col-lg-12">

        <div class="publish-wrapper">

            {% if cresults is not none %}

            <div class="text-center mb-2">
                <lottie-player 
                    src="https://assets2.lottiefiles.com/packages/lf20_w51pcehl.json" 
                    background="transparent" 
                    speed="1" 
                    style="width: 200px; height: 200px; margin: 0 auto;" 
                    loop autoplay>
                </lottie-player>
            </div>

            <h3 class="publish-title">
                <span>ï¿½</span> PUBLISH RESULTS
            </h3>

            <form action="/viewresults" method="POST" class="publish-form">
                <div>
                    <label for="livebox"><i class="fas fa-file-alt"></i> Choose Exam ID</label>
                    <select id="livebox" name="choosetid" class="custom-select" required>
                        {% for test in cresults %}
                        <option value="{{ test }}">{{ test }}</option>
                        {% endfor %}
                    </select>
                </div>

                <button type="submit" class="publish-btn">
                    View & Publish Results <i class="fas fa-arrow-right"></i>
                </button>
            </form>

            {% else %}

            <div class="no-data">
                <lottie-player 
                    src="https://assets7.lottiefiles.com/datafiles/vhvOcuUkH41HdrL/data.json" 
                    background="transparent" 
                    speed="1" 
                    style="width: 280px; height: 280px; margin: 0 auto; opacity: 0.8;" 
                    loop autoplay>
                </lottie-player>

                <h4>No Results Available</h4>
                <p>No exams found to publish, or results may already be finalized.</p>
                <small class="text-secondary mt-2 d-block">Note: Once results are published, they cannot be updated.</small>
            </div>

            {% endif %}

        </div>

    </div>
</div>

{% endblock %}